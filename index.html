<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ReActure - React for the Future</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="gameContainer">
        <!-- Homepage -->
        <div id="homepage">
            <!-- Logout Button (Top Right) -->
            <button id="logoutBtn" class="logoutBtnCorner hidden">üö™ Logout</button>
            
            <div class="homepageContent">
                <div class="heroSection">
                    <h1 class="gameTitle">ReActure</h1>
                    <p class="tagline">"React for the Future"</p>
                </div>
                
                <div class="streakDisplay">
                    <div class="streakIcon">üî•</div>
                    <div class="streakInfo">
                        <span class="streakLabel">Current Streak</span>
                        <span class="streakValue" id="streakValue">0 days</span>
                    </div>
                </div>
                
                <div class="quickStats">
                    <div class="statCard">
                        <div class="statIcon">üèÜ</div>
                        <div class="statValue" id="totalPoints">0</div>
                        <div class="statLabel">Total Points</div>
                    </div>
                    <div class="statCard">
                        <div class="statIcon">ü§ù</div>
                        <div class="statValue" id="friendsCount">0</div>
                        <div class="statLabel">Friends</div>
                    </div>
                    <div class="statCard">
                        <div class="statIcon">‚è±Ô∏è</div>
                        <div class="statValue" id="avgTime">0:00</div>
                        <div class="statLabel">Avg. Time</div>
                    </div>
                </div>
                
                <div class="actionButtons">
                    <button id="playNowBtn" class="primaryBtn">‚ö° Play Now</button>
                    <button id="viewLeaderboardBtn" class="secondaryBtn">üìä Leaderboard</button>
                    <button id="friendsBtn" class="secondaryBtn">üë• Friends</button>
                    <button id="notificationsBtn" class="secondaryBtn">üîî Notifications <span id="notificationBadge" class="notifBadge">0</span></button>
                </div>
                
                <p class="signInPrompt">Not logged in? <a href="#" id="signInLink">Sign In</a></p>
            </div>
        </div>
        
        <!-- REACT TIME Popup -->
        <div id="reactTimePopup" class="reactPopup hidden">
            <div class="reactPopupContent">
                <div class="reactPopupIcon">‚ö°</div>
                <h1 id="popupChallengeTitle">REACT TIME!</h1>
                <p id="popupChallengeDescription">It's time to react!</p>
                <button id="dismissReactPopup" class="primaryBtn">Let's Go!</button>
            </div>
        </div>
        
        <!-- Notifications Screen -->
        <div id="notificationsScreen" class="hidden">
            <div class="notificationsContent">
                <div class="notifHeader">
                    <h1>üîî Notifications</h1>
                    <button id="markAllReadBtn" class="smallBtn">Mark All Read</button>
                </div>
                <div id="notificationsList" class="notificationsList">
                    <!-- Populated dynamically -->
                </div>
                <button id="backFromNotifications" class="backBtn">‚Üê Back</button>
            </div>
        </div>
        
        <!-- Friends Screen -->
        <div id="friendsScreen" class="hidden">
            <div class="friendsContent">
                <h1>üë• Friends</h1>
                
                <div class="addFriendSection">
                    <input type="text" id="friendUsernameInput" placeholder="Enter friend's username" class="authInput">
                    <button id="addFriendBtn" class="primaryBtn">‚ûï Add Friend</button>
                </div>
                
                <div class="friendsTabs">
                    <button id="friendsListTab" class="tabBtn active">Friends List</button>
                    <button id="friendRequestsTab" class="tabBtn">Requests <span id="requestsBadge" class="requestsBadge">0</span></button>
                </div>
                
                <div id="friendsListSection" class="friendsSection">
                    <div id="friendsList" class="friendsList">
                        <!-- Populated dynamically -->
                    </div>
                </div>
                
                <div id="friendRequestsSection" class="friendsSection hidden">
                    <div id="friendRequestsList" class="friendRequestsList">
                        <!-- Populated dynamically -->
                    </div>
                </div>
                
                <button id="backFromFriends" class="backBtn">‚Üê Back</button>
            </div>
        </div>
        
        <!-- Sign In / Sign Up Screen -->
        <div id="authScreen" class="hidden">
            <div class="authContent">
                <h1 class="gameTitle">ReActure</h1>
                <p class="authSubtitle">Sign in to start your journey</p>
                
                <div id="signInForm" class="authForm">
                    <h2>Sign In</h2>
                    <input type="text" id="signInUsername" placeholder="Enter your username" class="authInput">
                    <button id="signInBtn" class="primaryBtn">Sign In</button>
                    <p class="switchAuth">New here? <a href="#" id="switchToSignUp">Create Account</a></p>
                </div>
                
                <div id="signUpForm" class="authForm hidden">
                    <h2>Create Account</h2>
                    <input type="text" id="signUpUsername" placeholder="Choose a username" class="authInput">
                    <input type="text" id="signUpDisplayName" placeholder="Your display name" class="authInput">
                    <button id="signUpBtn" class="primaryBtn">Create Account</button>
                    <p class="switchAuth">Already have an account? <a href="#" id="switchToSignIn">Sign In</a></p>
                </div>
                
                <button id="backToHomeBtn" class="backBtn">‚Üê Back to Home</button>
            </div>
        </div>
        
        <!-- Environment Selection Screen -->
        <div id="environmentScreen" class="hidden">
            <div class="envContent">
                <h1 class="envTitle">Choose Your Environment</h1>
                <p class="envSubtitle">Select the disaster scenario to simulate</p>
                
                <div class="environmentGrid">
                    <div class="envCard" data-env="earthquake">
                        <div class="envIcon">üèöÔ∏è</div>
                        <h3>Earthquake</h3>
                        <p>Buildings collapsed. Navigate unstable rubble and rescue victims from destroyed structures.</p>
                        <div class="envStats">
                            <span>‚ö†Ô∏è High Damage Risk</span>
                            <span>üß± Heavy Rubble</span>
                        </div>
                    </div>
                    
                    <div class="envCard" data-env="tsunami">
                        <div class="envIcon">üåä</div>
                        <h3>Tsunami</h3>
                        <p>Coastal flooding. Navigate water hazards and find victims in flooded areas.</p>
                        <div class="envStats">
                            <span>üíß Water Zones</span>
                            <span>‚ö° Fuel Drain</span>
                        </div>
                    </div>
                    
                    <div class="envCard" data-env="wildfire">
                        <div class="envIcon">üî•</div>
                        <h3>Wildfire</h3>
                        <p>Spreading flames. Race against time through fire zones to save lives.</p>
                        <div class="envStats">
                            <span>üî• Fire Damage</span>
                            <span>‚è±Ô∏è Time Pressure</span>
                        </div>
                    </div>
                </div>
                
                <button id="backToMenuBtn" class="backBtn">‚Üê Back to Menu</button>
            </div>
        </div>
        
        <!-- Leaderboard Screen -->
        <div id="leaderboardScreen" class="hidden">
            <div class="leaderboardContent">
                <h1 class="leaderboardTitle">üèÜ Leaderboard</h1>
                
                <div class="leaderboardTabs">
                    <button class="tabBtn active" data-tab="global">Global</button>
                    <button class="tabBtn" data-tab="friends">Friends</button>
                    <button class="tabBtn" data-tab="today">Today</button>
                </div>
                
                <div class="leaderboardList" id="leaderboardList">
                    <!-- Populated dynamically -->
                </div>
                
                <button id="backFromLeaderboardBtn" class="backBtn">‚Üê Back to Menu</button>
            </div>
        </div>
        
        <!-- Mission Briefing Screen -->
        <div id="startScreen" class="hidden">
            <div class="startContent">
                <h1 class="gameTitle">ReActure</h1>
                <p class="gameSubtitle" id="environmentName">Disaster Rescue Simulation</p>
                <div class="missionBrief">
                    <h2>Mission Briefing</h2>
                    <p id="missionDescription">A disaster has struck. Multiple victims are trapped under rubble.</p>
                    <p>Your mission: Rescue all victims before their health depletes.</p>
                    <ul class="missionList">
                        <li>üîç X-ray scan to see through rubble (E key - 3 seconds)</li>
                        <li>üí• Destroy rubble to clear paths (Space key)</li>
                        <li>üÜò Click mouse to rescue when victim pulses green</li>
                        <li>‚ö° Manage your fuel and health</li>
                        <li>‚ö†Ô∏è Avoid hazard zones carefully</li>
                        <li>‚õΩ Refuel at the station when needed (R key)</li>
                    </ul>
                </div>
                <div class="controlsInfo">
                    <h3>Controls</h3>
                    <div class="controlsGrid">
                        <div class="controlItem">
                            <kbd>W</kbd><kbd>A</kbd><kbd>S</kbd><kbd>D</kbd>
                            <span>Move</span>
                        </div>
                        <div class="controlItem">
                            <kbd>Mouse</kbd>
                            <span>Look Around</span>
                        </div>
                        <div class="controlItem">
                            <kbd>E</kbd>
                            <span>X-ray Scan</span>
                        </div>
                        <div class="controlItem">
                            <kbd>Space</kbd>
                            <span>Destroy</span>
                        </div>
                        <div class="controlItem">
                            <kbd>Click</kbd>
                            <span>Rescue</span>
                        </div>
                        <div class="controlItem">
                            <kbd>R</kbd>
                            <span>Refuel</span>
                        </div>
                        <div class="controlItem">
                            <kbd>ESC</kbd>
                            <span>Pause</span>
                        </div>
                    </div>
                </div>
                <button id="startBtn" class="primaryBtn">Start Mission</button>
            </div>
        </div>

        <!-- Game UI -->
        <div id="ui" class="hidden">
            <div id="topBar">
                <div class="stat stat-primary">
                    <span class="statIcon">‚è±Ô∏è</span>
                    <span class="label">Time:</span>
                    <span id="timer" class="statValue">00:00</span>
                </div>
                <div class="stat stat-success">
                    <span class="statIcon">‚úÖ</span>
                    <span class="label">Saved:</span>
                    <span id="savedCount" class="statValue">0</span>
                </div>
                <div class="stat stat-warning">
                    <span class="statIcon">üö®</span>
                    <span class="label">Remaining:</span>
                    <span id="remainingCount" class="statValue">0</span>
                </div>
                <div class="stat stat-points">
                    <span class="statIcon">üèÜ</span>
                    <span class="label">Score:</span>
                    <span id="scoreValue" class="statValue">0</span>
                </div>
            </div>
            
            <div id="robotStats">
                <div class="panelHeader">
                    <span class="panelIcon">ü§ñ</span>
                    <span>Robot Status</span>
                </div>
                <div class="barContainer">
                    <div class="barLabel">
                        <span class="label">Health</span>
                        <span id="robotHealthText" class="barValue">100%</span>
                    </div>
                    <div class="bar healthBar">
                        <div id="robotHealth" class="fill"></div>
                        <div class="barGlow healthGlow"></div>
                    </div>
                </div>
                <div class="barContainer">
                    <div class="barLabel">
                        <span class="label">Fuel/Battery</span>
                        <span id="robotFuelText" class="barValue">100%</span>
                    </div>
                    <div class="bar fuelBar">
                        <div id="robotFuel" class="fill"></div>
                        <div class="barGlow fuelGlow"></div>
                    </div>
                </div>
            </div>

            <div id="controls" class="infoPanel">
                <div class="panelHeader">
                    <span class="panelIcon">‚å®Ô∏è</span>
                    <span>Controls</span>
                </div>
                <div class="controlList">
                    <div class="controlRow">
                        <kbd>WASD</kbd>
                        <span>Move</span>
                    </div>
                    <div class="controlRow">
                        <kbd>Mouse</kbd>
                        <span>Look</span>
                    </div>
                    <div class="controlRow">
                        <kbd>E</kbd>
                        <span>X-ray Scan</span>
                    </div>
                    <div class="controlRow">
                        <kbd>Space</kbd>
                        <span>Destroy</span>
                    </div>
                    <div class="controlRow">
                        <kbd>Click</kbd>
                        <span>Rescue</span>
                    </div>
                    <div class="controlRow">
                        <kbd>R</kbd>
                        <span>Refuel</span>
                    </div>
                    <div class="controlRow">
                        <kbd>ESC</kbd>
                        <span>Pause</span>
                    </div>
                </div>
            </div>

            <div id="sensorDisplay" class="infoPanel">
                <div class="panelHeader">
                    <span class="panelIcon">üì°</span>
                    <span>Sensors</span>
                </div>
                <div id="sensorData" class="sensorList">
                    <div class="sensorRow">
                        <span class="sensorLabel">Proximity:</span>
                        <span id="proximity" class="sensorValue">0.0m</span>
                    </div>
                    <div class="sensorRow">
                        <span class="sensorLabel">Zone:</span>
                        <span id="zoneType" class="sensorValue zone-safe">Safe</span>
                    </div>
                    <div class="sensorRow">
                        <span class="sensorLabel">Victims:</span>
                        <span id="victimsDetected" class="sensorValue">0</span>
                    </div>
                </div>
            </div>

            <div id="crosshair">
                <div class="crosshairDot"></div>
                <div class="crosshairLine crosshairH"></div>
                <div class="crosshairLine crosshairV"></div>
            </div>
            
            <div id="pointerLockPrompt" class="pointerPrompt">
                <p>üñ±Ô∏è Click to enable mouse look</p>
                <p class="promptSmall">Press ESC to release</p>
            </div>
            
            <div id="rescueMessage" class="rescueMessage hidden"></div>
        </div>

        <canvas id="gameCanvas" class="hidden"></canvas>
        
        <!-- Pause Menu -->
        <div id="pauseMenu" class="pauseMenu hidden">
            <div class="pauseContent">
                <h1>‚è∏Ô∏è Paused</h1>
                <p>Press ESC to resume</p>
                <div class="pauseButtons">
                    <button id="resumeBtn" class="primaryBtn">‚ñ∂Ô∏è Resume</button>
                    <button id="quitToMenuBtn" class="secondaryBtn">üè† Quit to Menu</button>
                </div>
                <div class="pauseInfo">
                    <p><kbd>ESC</kbd> - Pause/Resume</p>
                    <p><kbd>E</kbd> - Inspect (reveals nearby victims)</p>
                    <p><kbd>Space</kbd> - Jump (moving) / Destroy (stationary)</p>
                </div>
            </div>
        </div>
        
        <div id="gameOverScreen" class="hidden">
            <div class="gameOverContent">
                <h1 id="gameOverTitle">Mission Complete</h1>
                <div id="gameOverStats"></div>
                <div id="scoreBreakdown" class="scoreBreakdown"></div>
                <div id="shareSection" class="shareSection">
                    <h3>Share Your Results</h3>
                    <button id="shareTwitterBtn" class="shareBtn">üê¶ Share on Twitter</button>
                    <button id="shareInstagramBtn" class="shareBtn">üì∏ Share on Instagram</button>
                    <button id="copyResultsBtn" class="shareBtn">üìã Copy Summary</button>
                </div>
                <div class="buttonGroup">
                    <button id="restartBtn" class="primaryBtn">Play Again</button>
                    <button id="downloadLogsBtn" class="secondaryBtn">üì• Download Data</button>
                    <button id="backToMenuFromGame" class="secondaryBtn">üè† Main Menu</button>
                </div>
            </div>
        </div>
    </div>

    <script type="importmap">
    {
        "imports": {
            "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js",
            "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/"
        }
    }
    </script>
    <script src="numpy_writer.js"></script>
    <script type="module" src="game.js"></script>
</body>
</html>

